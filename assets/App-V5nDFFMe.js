import{r as u,j as e,k as y,l as A,m as j,u as L}from"./react-vendor-Cz34A0j2.js";import{U as b,u as S,b as k,c as E,A as p}from"./index-C3SH5KaD.js";import"./vendor-7OC5HNn7.js";import"./state-CWLQzQDb.js";function G({children:a,oauthServiceUrl:t,onAuthChange:n,isAuthenticated:o}){const[r,i]=u.useState(!0),[l,x]=u.useState(!1);return u.useEffect(()=>{const s=document.createElement("script");return s.src=`${t}/github-auth.js?v=${Date.now()}`,s.async=!0,s.onload=()=>{setTimeout(()=>{window.GitHubAuth?x(!0):(console.error("GitHubAuth not available after script load"),i(!1))},100)},s.onerror=()=>{console.error("Failed to load OAuth script"),i(!1)},document.head.appendChild(s),()=>{document.head.contains(s)&&document.head.removeChild(s)}},[t]),u.useEffect(()=>{if(l)if(window.GitHubAuth.isAuthenticated()){const s=window.GitHubAuth.getUser(),c=window.GitHubAuth.getToken();s&&c&&setTimeout(()=>{n(c,s),i(!1)},0)}else window.GitHubAuth.init({scope:"repo",onLogin:s=>{const c=window.GitHubAuth.getUser();c&&setTimeout(()=>{n(s,c),i(!1)},0)}}),i(!1)},[l,n]),r?e.jsx("div",{className:"loading",children:e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("div",{style:{border:"4px solid rgba(255,255,255,0.3)",borderRadius:"50%",borderTopColor:"white",width:"50px",height:"50px",animation:"spin 1s linear infinite",margin:"0 auto 20px"}}),e.jsx("p",{children:"Initializing..."})]})}):o?e.jsx(e.Fragment,{children:a}):e.jsx("div",{className:"loading",children:e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("h2",{children:"Authentication Required"}),e.jsx("p",{style:{marginTop:16,marginBottom:24,opacity:.9},children:"Please sign in with GitHub to access the gallery"}),e.jsx("button",{onClick:()=>window.GitHubAuth.login(),style:{background:"linear-gradient(135deg, #1e3a5f 0%, #2c4f7c 100%)",color:"white",border:"none",padding:"12px 24px",borderRadius:"8px",fontSize:"16px",fontWeight:"500",cursor:"pointer"},children:"Sign in with GitHub"})]})})}function H(a,t){if(!a?.minLauncherVersion||!t)return null;const n=t.split(".").map(Number),o=a.minLauncherVersion.split(".").map(Number);for(let r=0;r<3;r++){if(n[r]<o[r])return`Requires launcher v${a.minLauncherVersion}`;if(n[r]>o[r])return null}return null}function z({appName:a,manifest:t,path:n,onLaunch:o,version:r}){if(!t)return e.jsx("div",{className:"bg-white rounded-2xl border border-neutral-200 shadow-sm overflow-hidden",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-xl font-semibold text-neutral-900 mb-2",children:a}),e.jsx("p",{className:"text-neutral-400",children:"Loading..."})]})});const i=H(t,r);return e.jsxs("div",{className:"bg-white rounded-xl border border-neutral-200 shadow-sm hover:shadow-md hover:-translate-y-0.5 transition-all duration-150 overflow-hidden group flex flex-col h-full",children:[e.jsx("div",{className:`w-full bg-gradient-to-br from-brand-50 to-neutral-50 flex items-center justify-center ${t.thumbnail?"h-32":"h-20"}`,children:t.thumbnail?e.jsx("img",{src:t.thumbnail,alt:t.name,loading:"lazy",className:"w-full h-full object-cover",onError:l=>{l.currentTarget.style.display="none"}}):e.jsx("div",{className:"text-4xl text-neutral-400",children:t.name.charAt(0)})}),e.jsxs("div",{className:"p-4 flex flex-col flex-1",children:[e.jsx("h3",{className:"text-base font-semibold text-neutral-900 mb-1",children:t.name}),e.jsx("p",{className:"text-neutral-600 text-xs leading-relaxed mb-3 line-clamp-2",children:t.description}),i&&e.jsxs("div",{className:"flex items-center gap-1.5 text-amber-600 text-xs mb-3 bg-amber-50 px-2 py-1.5 rounded",children:[e.jsx(y,{size:12}),e.jsx("span",{className:"text-[10px]",children:i})]}),t.tech&&t.tech.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1.5 mb-3",children:t.tech.map(l=>e.jsx("span",{className:"bg-neutral-100 text-neutral-700 px-2 py-0.5 rounded-full text-[10px] font-medium",children:l},l))}),e.jsxs("button",{onClick:()=>o(n,t.name),"aria-label":`Launch ${t.name} app`,className:"inline-flex items-center justify-center gap-1.5 bg-gradient-to-r from-brand-600 to-brand-700 hover:from-brand-700 hover:to-brand-800 text-white px-3 py-2 rounded-lg font-medium text-xs transition-all duration-150 group-hover:gap-2 mt-auto",children:["Launch App",e.jsx(A,{size:14,className:"transition-transform duration-150"})]})]})]})}function C({config:a,user:t,onLogout:n,onClearCache:o,onTrack:r,onNavigate:i}){const[l,x]=u.useState([]),[s,c]=u.useState(!0),[f,v]=u.useState(null);u.useEffect(()=>{N()},[]);const N=async()=>{try{c(!0);const d=await fetch("/apps-registry.json");if(!d.ok)throw new Error("Failed to load apps registry");const h=(await d.json()).apps.map(m=>({name:m.name,path:m.path,manifest:m.manifest}));x(h),c(!1)}catch(d){v(d.message),c(!1)}},w=u.useCallback((d,g)=>{r?.("app_launch",{appName:g,appPath:d});const h=l.find(m=>m.path===d)?.manifest;h?.reactRoute&&i&&i(h.reactRoute)},[l,r,i]);return s&&l.length===0?e.jsxs("div",{className:"relative min-h-screen",children:[e.jsx("div",{className:"fixed top-[70%] left-[75%] -translate-x-1/2 -translate-y-1/2 w-[300px] h-[300px] sm:w-[600px] sm:h-[600px] rounded-full bg-brand-500 blur-[100px] sm:blur-[150px] opacity-40 animate-breathe pointer-events-none"}),e.jsx(b,{user:t,onLogout:n,onClearCache:o}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("header",{className:"py-16 sm:py-24 text-center",children:[e.jsxs("h1",{className:"text-4xl sm:text-5xl font-semibold text-neutral-900 flex items-center justify-center gap-3 mb-3",children:[e.jsx(j,{className:"text-brand-600",size:40}),a.branding.title]}),e.jsx("p",{className:"text-lg text-neutral-600 max-w-2xl mx-auto px-4",children:a.branding.subtitle})]}),e.jsx("div",{className:"flex justify-center items-center py-20",children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 border-4 border-neutral-200 border-t-brand-600 rounded-full animate-[spin_1s_linear_infinite]"}),e.jsx("p",{className:"text-neutral-600",children:"Loading applications..."})]})})]})]}):f?e.jsxs("div",{className:"relative min-h-screen",children:[e.jsx(b,{user:t,onLogout:n,onClearCache:o}),e.jsx("div",{className:"container py-8",children:e.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-800 rounded-xl p-6",children:[e.jsx("strong",{className:"font-semibold",children:"Error:"})," ",f]})})]}):e.jsxs("div",{className:"relative min-h-screen",children:[e.jsx("div",{className:"fixed top-[70%] left-[75%] -translate-x-1/2 -translate-y-1/2 w-[300px] h-[300px] sm:w-[600px] sm:h-[600px] rounded-full bg-brand-500 blur-[100px] sm:blur-[150px] opacity-40 animate-breathe pointer-events-none"}),e.jsx(b,{user:t,onLogout:n,onClearCache:o}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("header",{className:"py-16 sm:py-24 text-center",children:[e.jsxs("h1",{className:"text-4xl sm:text-5xl font-semibold text-neutral-900 flex items-center justify-center gap-3 mb-3",children:[e.jsx(j,{className:"text-brand-600",size:40}),a.branding.title]}),e.jsx("p",{className:"text-lg text-neutral-600 max-w-2xl mx-auto px-4",children:a.branding.subtitle})]}),e.jsx("div",{className:"container pb-20",children:e.jsx("div",{className:"grid",children:l.map(d=>e.jsx(z,{appName:d.name,manifest:d.manifest,path:d.path,onLaunch:w},d.name))})})]})]})}function _(){const a=L(),{user:t,token:n,isAuthenticated:o,setAuth:r,logout:i}=S(),{clearCache:l}=k(),{track:x}=E();return e.jsx(G,{oauthServiceUrl:p.oauth.serviceUrl,onAuthChange:(s,c)=>{s&&c&&r(s,c)},isAuthenticated:o,children:e.jsx(C,{config:p,user:t,token:n,onLogout:i,onClearCache:()=>l(p.repository.owner,p.repository.name),onTrack:x,onNavigate:s=>a(s)})})}export{_ as default};
