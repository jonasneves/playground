import{r as a,j as e,A as E}from"./react-vendor-Cz34A0j2.js";import{u as g}from"./useLocalStorage-Dd71kNJg.js";import{u as S}from"./usePerformanceMonitor-CRkjAzvk.js";import{u as M}from"./index-Bb0P9kli.js";import"./vendor-7OC5HNn7.js";import"./state-CWLQzQDb.js";const w=a.memo(({message:t,style:n})=>t.role==="user"?e.jsx("div",{style:n,className:"flex justify-end","data-role":t.role,children:e.jsx("div",{className:"px-5 py-3 rounded-2xl rounded-br-sm bg-[#00539B] text-white text-[15px] leading-relaxed max-w-[85%] shadow-sm",children:t.content})}):t.role==="assistant"?e.jsxs("div",{style:n,className:"flex gap-3","data-role":t.role,children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-[#00539B]/10 flex items-center justify-center flex-shrink-0",children:e.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",className:"text-[#00539B]",children:e.jsx("path",{d:"M22 12h-4l-3 9L9 3l-3 9H2"})})}),e.jsx("div",{className:"px-5 py-3 rounded-2xl rounded-tl-sm bg-white border border-neutral-200 text-neutral-700 text-[15px] leading-relaxed max-w-[85%] shadow-sm",children:t.content})]}):e.jsx("div",{style:n,className:"flex justify-center","data-role":t.role,children:e.jsx("div",{className:"px-4 py-2 rounded-lg bg-amber-50 border border-amber-200 text-amber-800 text-sm text-center max-w-[85%]",children:t.content})}));w.displayName="MessageBubble";const v=50,j=100;function k({messages:t}){const n=a.useRef(null),l=a.useRef(!0),r=a.useMemo(()=>t.length<=v?t:t.slice(-j),[t]);a.useEffect(()=>{l.current&&n.current&&(n.current.scrollTop=n.current.scrollHeight)},[t]);const s=()=>{if(!n.current)return;const{scrollTop:c,scrollHeight:i,clientHeight:o}=n.current,x=Math.abs(i-o-c)<50;l.current=x};return e.jsx("div",{ref:n,className:"flex-1 overflow-y-auto px-6 py-6",id:"chat",onScroll:s,children:t.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center px-8",children:[e.jsx("div",{className:"w-20 h-20 bg-[#00539B]/10 rounded-3xl flex items-center justify-center mb-6",children:e.jsx("svg",{width:"32",height:"32",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"text-[#00539B]",children:e.jsx("path",{d:"M22 12h-4l-3 9L9 3l-3 9H2"})})}),e.jsx("h2",{className:"text-xl font-bold text-neutral-900 mb-2",children:"AI Chat"}),e.jsx("p",{className:"text-sm text-neutral-500 max-w-sm",children:"Start a conversation with AI"})]}):e.jsxs("div",{className:"space-y-4",children:[t.length>v&&e.jsxs("div",{className:"text-center text-xs text-neutral-400 py-2",children:["Showing last ",j," of ",t.length," messages"]}),r.map((c,i)=>e.jsx(w,{message:c},c.id||i))]})})}function B({onSend:t,disabled:n}){const[l,r]=a.useState(""),s=a.useRef(null);a.useEffect(()=>{n||s.current?.focus()},[n]);const c=()=>{const o=l.trim();!o||n||(t(o),r(""),s.current?.focus())},i=o=>{o.key==="Enter"&&!o.shiftKey&&(o.preventDefault(),c())};return e.jsx("div",{className:"px-6 py-5 bg-white border-t border-[#E2E8F0]",children:e.jsxs("div",{className:"flex items-center gap-2 pl-5 pr-2 py-2 bg-[#F8FAFC] border border-[#E2E8F0] rounded-[28px] transition-all focus-within:border-[#00539B] focus-within:shadow-[0_0_0_3px_rgba(0,83,155,0.1)]",children:[e.jsx("input",{ref:s,type:"text",id:"input",value:l,onChange:o=>r(o.target.value),onKeyDown:i,placeholder:"Type a message...",disabled:n,className:"flex-1 py-2 px-0 bg-transparent border-none text-[15px] text-[#0F172A] placeholder-[#94A3B8] focus:outline-none disabled:text-neutral-400"}),e.jsx("button",{onClick:c,disabled:n||!l.trim(),id:"send-btn",className:"w-10 h-10 p-0 flex items-center justify-center bg-[#00539B] hover:bg-[#012169] text-white rounded-full transition-all disabled:bg-[#CBD5E1] disabled:text-[#94A3B8] disabled:cursor-not-allowed flex-shrink-0","aria-label":"Send message",children:e.jsx(E,{size:18})})]})})}const R=[{value:"gpt-4o",label:"GPT-4o"},{value:"gpt-4o-mini",label:"GPT-4o Mini"},{value:"meta-llama-3.1-70b-instruct",label:"Llama 3.1 70B"},{value:"mistral-large",label:"Mistral Large"}];function I({selectedModel:t,onModelChange:n,onClearChat:l}){return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("select",{id:"model",value:t,onChange:r=>n(r.target.value),className:"px-3 py-1.5 text-xs bg-white/10 text-white border border-white/20 rounded-full focus:outline-none focus:bg-white/20 transition-colors",children:R.map(r=>e.jsx("option",{value:r.value,className:"text-neutral-900",children:r.label},r.value))}),e.jsx("button",{onClick:l,className:"px-3 py-1.5 text-xs text-white/80 hover:text-white hover:bg-white/10 rounded-full transition-colors",children:"Clear"})]})}function _(t,n={}){const{maxBatchSize:l=1/0}=n,r=a.useRef([]),s=a.useRef(void 0),c=a.useCallback(o=>{const x=Array.isArray(o)?o:[o];if(r.current.push(...x),r.current.length>=l){s.current!==void 0&&(cancelAnimationFrame(s.current),s.current=void 0),t(r.current),r.current=[];return}s.current||(s.current=requestAnimationFrame(()=>{t(r.current),r.current=[],s.current=void 0}))},[t,l]),i=a.useCallback(()=>{s.current!==void 0&&(cancelAnimationFrame(s.current),s.current=void 0),r.current.length>0&&(t(r.current),r.current=[])},[t]);return a.useEffect(()=>()=>{s.current!==void 0&&cancelAnimationFrame(s.current)},[]),{accumulate:c,flush:i}}function P(){const t=M(d=>d.token),{startTimer:n,endTimer:l}=S("chat"),[r,s,c]=g("chat_history",[]),[i,o]=g("chat_model","gpt-4o-mini"),[x,m]=a.useState(!1);a.useEffect(()=>{l("ttfr")},[l]);const y=a.useCallback(d=>{s(u=>[...u,...d])},[s]),{accumulate:p}=_(y),h=a.useCallback((d,u)=>{const b={role:d,content:u,id:`${Date.now()}-${Math.random()}`};p(b)},[p]),N=a.useCallback(async d=>{if(!(!t||x)){m(!0),h("user",d);try{n("api_latency_ms");const u=await fetch("https://models.inference.ai.azure.com/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify({model:i,messages:[...r,{role:"user",content:d}].slice(-20).map(f=>({role:f.role,content:f.content})),temperature:.7,max_tokens:1e3})});if(!u.ok){const f=await u.json().catch(()=>({error:{message:`API error: ${u.status}`}}));throw new Error(f.error?.message||`API error: ${u.status}`)}const A=(await u.json()).choices[0].message.content;l("api_latency_ms"),h("assistant",A)}catch(u){h("system",`Error: ${u.message}`)}finally{m(!1)}}},[t,i,r,x,h,n,l]),C=a.useCallback(()=>{confirm("Clear all chat history?")&&c()},[c]);return e.jsxs("div",{className:"h-screen flex flex-col bg-[#E2E6ED]",children:[e.jsxs("div",{className:"bg-[#012169] px-6 py-3.5 flex items-center justify-between",children:[e.jsx("h1",{className:"text-lg font-bold text-white",children:"AI Chat"}),e.jsx(I,{selectedModel:i,onModelChange:o,onClearChat:C})]}),e.jsx("div",{className:"flex-1 flex justify-center p-6 overflow-hidden",children:e.jsxs("div",{className:"w-full max-w-[800px] bg-white rounded-3xl shadow-2xl flex flex-col overflow-hidden",children:[e.jsx(k,{messages:r}),e.jsx(B,{onSend:N,disabled:x})]})})]})}export{P as default};
